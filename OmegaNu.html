<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Î©mega Nu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {margin:0; background:#000; overflow:hidden;}
  canvas {display:block; margin:auto; background:#000; cursor:none;}
</style>
</head>
<body>
<canvas id="game" width="800" height="600"></canvas>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let ship = {x:400, y:300, vx:0, vy:0, angle:0};
let bullets=[], particles=[];
let target = {x:Math.random()*800, y:Math.random()*600, vx:(Math.random()-0.5)*2, vy:(Math.random()-0.5)*2};

const ROTATE_STEP=6, THRUST_POWER=0.4, DRAG=0.995, BOUNCE_DAMP=0.9;

function thrust(){
  const rad=(ship.angle-90)*Math.PI/180;  // bow points up
  ship.vx+=Math.cos(rad)*THRUST_POWER;
  ship.vy+=Math.sin(rad)*THRUST_POWER;
  const back=rad+Math.PI;
  particles.push({
    x:ship.x+Math.cos(back)*12,
    y:ship.y+Math.sin(back)*12,
    vx:Math.cos(back)*(1+Math.random())*1.2,
    vy:Math.sin(back)*(1+Math.random())*1.2,
    life:40
  });
}

function fire(){
  const rad=(ship.angle-90)*Math.PI/180;
  bullets.push({
    x:ship.x+Math.cos(rad)*12,
    y:ship.y+Math.sin(rad)*12,
    vx:Math.cos(rad)*10+ship.vx,
    vy:Math.sin(rad)*10+ship.vy,
    life:60
  });
}

window.addEventListener("contextmenu",e=>e.preventDefault());
canvas.addEventListener("mousedown",e=>{
  if(e.button===0)fire();
});
canvas.addEventListener("wheel",e=>{
  e.preventDefault();
  if(e.deltaY<0)ship.angle+=ROTATE_STEP;
  else ship.angle-=ROTATE_STEP;
});

let thrusting=false;
canvas.addEventListener("mousedown",e=>{if(e.button===2)thrusting=true;});
canvas.addEventListener("mouseup",e=>{if(e.button===2)thrusting=false;});

function update(){
  if(thrusting)thrust();
  ship.vx*=DRAG; ship.vy*=DRAG;
  ship.x+=ship.vx; ship.y+=ship.vy;

  // bounce edges
  if(ship.x<0){ship.x=0;ship.vx=-ship.vx*BOUNCE_DAMP;}
  if(ship.x>800){ship.x=800;ship.vx=-ship.vx*BOUNCE_DAMP;}
  if(ship.y<0){ship.y=0;ship.vy=-ship.vy*BOUNCE_DAMP;}
  if(ship.y>600){ship.y=600;ship.vy=-ship.vy*BOUNCE_DAMP;}

  // target motion
  target.x+=target.vx; target.y+=target.vy;
  if(target.x<10||target.x>790)target.vx*=-1;
  if(target.y<10||target.y>590)target.vy*=-1;

  // bullets
  bullets.forEach(b=>{b.x+=b.vx; b.y+=b.vy; b.life--;});
  bullets=bullets.filter(b=>b.life>0);

  // particles
  particles.forEach(p=>{p.x+=p.vx; p.y+=p.vy; p.life--;});
  particles=particles.filter(p=>p.life>0);

  // collisions
  for(let b of bullets){
    const dx=b.x-target.x, dy=b.y-target.y;
    if(Math.hypot(dx,dy)<12){
      target={x:Math.random()*800, y:Math.random()*600,
              vx:(Math.random()-0.5)*2, vy:(Math.random()-0.5)*2};
      b.life=0;
    }
  }
}

function drawShip(){
  ctx.save();
  ctx.translate(ship.x,ship.y);
  ctx.rotate(ship.angle*Math.PI/180);
  ctx.strokeStyle="cyan"; ctx.lineWidth=2;
  ctx.beginPath();
  ctx.moveTo(-10,10);
  ctx.lineTo(0,-10);
  ctx.lineTo(10,10);
  ctx.stroke();
  ctx.restore();
}

function draw(){
  ctx.fillStyle="#000"; ctx.fillRect(0,0,800,600);
  // exhaust
  for(let p of particles){
    const fade=p.life/40;
    ctx.fillStyle=`rgb(255,${180*fade|0},${40*fade|0})`;
    ctx.beginPath(); ctx.arc(p.x,p.y,2,0,Math.PI*2); ctx.fill();
  }
  // target
  ctx.strokeStyle="red"; ctx.lineWidth=2;
  ctx.beginPath(); ctx.arc(target.x,target.y,8,0,Math.PI*2); ctx.stroke();
  // bullets
  ctx.fillStyle="blue";
  for(let b of bullets){ctx.beginPath();ctx.arc(b.x,b.y,2,0,Math.PI*2);ctx.fill();}
  drawShip();
}

function loop(){update();draw();requestAnimationFrame(loop);}
loop();
</script>
</body>
</html>
